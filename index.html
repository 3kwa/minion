<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <title>dominion</title>
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/jquery.terminal/js/jquery.terminal.min.js"></script>
    <link rel="stylesheet" href="node_modules/jquery.terminal/css/jquery.terminal.min.css" />
<style>
html, body {
    margin: 0;
    height: 100%;
}
#footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    text-align: center;
    font-family: "Courier New", courier, monospace;
    padding: .3em;
    background-color: beige;
}
</style>
  </head>
  <body>
    <div id="terminal"></div>
    <div id="footer">
      node: <span id="node-version"></span>
      chromium: <span id="chrome-version"></span>
      electron: <span id="electron-version"></span>
    </div>
    <script>
        // not sure how to get window inside terminal so ...
        // minion:
        const open = (url) => { window.electronAPI.open(url) };
        const info = () => { window.electronAPI.info() };
        // workspace:
        const save = (workspace) => { window.electronAPI.save(workspace) };
        const desc = (workspace) => { window.electronAPI.desc(workspace) };
        const load = (workspace) => { window.electronAPI.load(workspace) };
        const dele = (workspace) => { window.electronAPI.dele(workspace) };
        const list = () => { return window.electronAPI.list() };
        // dominion:
        const help = `minion:
  open <url>       : opens a new window (minion) and loads <url>
  info             : list opened minions
workspace:
  save <workspace> : saves current <workspace> i.e. url, position, etc. of each minion
  desc <workspace> : list minions saved in <workspace>
  load <workspace> : loads saved <workspace>
  dele <workspace> : delete <workspace>
  list             : lists all saved workspaces
dominion:
  help             : ...
  quit             : closes (do)minion and all its minions`
        const quit = () => { window.electronAPI.quit() };
        // the terminal !!!
    jQuery(function($, undefined) {
        $('#terminal').terminal({
            // minion:
            open: (url) => {
                open(url)
            },
            info: () => {
                open(url)
            },
            // workspace:
            save: (workspace) => {
                save(workspace)
            },
            desc: (workspace) => {
                desc(workspace)
            },
            load: (workspace) => {
                load(workspace)
            },
            dele: (workspace) => {
                dele(workspace)
            },
            list: function() {
                list().then((result) => {
                    result.forEach((workspace, index) => {
                        this.echo(`  ${workspace}`)
                    })
                })
            },
            // dominion:
            help: function() {
                this.echo(help);
            },
            quit: quit,

        }, {
            greetings: `minimalistic HTML/CSS/JavaScript viewer
---------------------------------------
minion:
  [1] a servile follower or underling
  [2] one highly favored
dominion:
  [1] supreme authority
  [2] absolute ownership
---------------------------------------
>>> help
${help}`,
            height: 600,
            prompt: '>>> ',
            keymap: {
                'CTRL+D': function(e, original) { quit() },
            }
        });
    });
    </script>
  </body>
</html>
